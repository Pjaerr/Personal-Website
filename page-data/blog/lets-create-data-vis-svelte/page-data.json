{"componentChunkName":"component---src-templates-blog-post-template-js","path":"/blog/lets-create-data-vis-svelte","webpackCompilationHash":"","result":{"data":{"markdownRemark":{"html":"<p>If you haven't heard of <a href=\"https://svelte.dev/\">Svelte</a>, it is a relatively new JavaScript framework that challenges the norm by being shifting the bulk of the work from the browser to the compile step.</p>\n<p>In doing that, it brings many benefits, most notably, the ability to ship less code to the browser (as you don't need the entire library like with frameworks such as React or Vue). It does a bunch more stuff like scrapping the virtual DOM but I won't be talking about any of that as, in my opinion, the main benefit of Svelte is how easy it is to get started and how nice it is to use from a development perspective.</p>\n<h2>What are we going to build?</h2>\n<p>So now we have gotten the intro out of the way, let's talk about what we're going to build and why.</p>\n<p>When learning a new language/framework it is often de-facto to just build a todo app as it covers most bases and lets you see its usage within a sort of real-world application but to me a todo app is really boring, I use one everyday but I don't really want to build one. That's where this idea comes in.</p>\n<p>We're going to create a <em>Data Visualization</em> using Svelte. This data visualization will show, on a map of the UK &#x26; Ireland, which regions have contributed most to the English Premier League title wins since its creation in 1992. The main reason I chose this topic is that there is so much data available, but it is also scoped small enough for an article (hopefully ü§û).</p>\n<p>You can find a demo of this data visualization at the following link: LINK_HERE</p>\n<p>or you can just view the gif below:</p>\n<h2>Setup üõ†Ô∏è</h2>\n<p>I won't go too deep into setting up Svelte as there are already guides on this, but the steps below should be enough to get started:</p>\n<ol>\n<li>Run <code class=\"language-text\">npx degit sveltejs/template premier-league-data-vis</code></li>\n<li>Run <code class=\"language-text\">cd premier-league-data-vis</code></li>\n<li>Run <code class=\"language-text\">npm install</code></li>\n<li>Delete the contents of the default <code class=\"language-text\">App.svelte</code> and <code class=\"language-text\">main.js</code> files.</li>\n<li>Run <code class=\"language-text\">npm run dev</code></li>\n</ol>\n<h2>The Data üìä</h2>\n<p>For this project we will need the following data:</p>\n<ul>\n<li>Each team that has won the premier league since its creation in 1992.</li>\n<li>For each team that has won, the season they won and the squad that played in the season they won.</li>\n<li>A list of players from the UK and Ireland who had atleast 1 appearance for a winning team and the region they were born in.</li>\n</ul>\n<p>To get the football data I will be using the following <a href=\"https://www.worldfootball.net/winner/eng-premier-league/\">website</a> and then for each player I will just search for the region they are from.</p>\n<p>Our data will look something like the following,</p>\n<p>Every player:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">;</span><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Marc Albrighton\"</span><span class=\"token punctuation\">,</span>\n    regions<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"Staffordshire\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>and each season:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"season\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"2015/2016\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"winner\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Leicester City\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"players\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Marc Albrighton\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">\"appearances\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">38</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Fortunately, you don't have to go through and grab all of the data as I have already done so.</p>\n<p>In your project, create a folder in <code class=\"language-text\">src</code> called <code class=\"language-text\">Data</code> and then create the following files:</p>\n<ul>\n<li><code class=\"language-text\">Players.js</code> - This will have every player and the region[s] they are from.</li>\n<li><code class=\"language-text\">Titles.js</code> - This will have each premier league season, the team that won it and the squad they won it with.</li>\n<li><code class=\"language-text\">Regions.js</code> - We'll get to this in the next section, but this will hold each region of our map.</li>\n</ul>\n<p>You can then populate these files with the data at the following link: <a href=\"https://github.com/Pjaerr/Svelte-Data-Vis-Premier-League/src/Data\">https://github.com/Pjaerr/Svelte-Data-Vis-Premier-League/src/Data</a></p>\n<h2>The Map üó∫Ô∏è</h2>\n<p>Now we have our data, we need the map. For this project I will be using a map of the UK and Ireland that I found <a href=\"https://mapsvg.com/maps/united-kingdom-counties/\">here</a>. We can download this map as an SVG but we won't be directly using it as an SVG. For our purposes we need each <code class=\"language-text\">&lt;path&gt;</code> within the SVG to be seperated out. This is where our <code class=\"language-text\">Regions.js</code> file comes in.</p>\n<p>Feel free to just copy the contents of the file from Github to speed things up, but if you feel like spending the time, you should do the following:</p>\n<ol>\n<li>Open up the downloaded SVG in a text editor.</li>\n<li>In the <code class=\"language-text\">Regions.js</code> file, we want to export a default array that has objects inside of it, these objects will have a name and an svgPath property.</li>\n<li>For each <code class=\"language-text\">&lt;path&gt;</code> in the SVG, create an object in the <code class=\"language-text\">Regions.js</code> file with the name of the region and the svgPath.</li>\n</ol>\n<p>Your <code class=\"language-text\">Regions.js</code> file should look something like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    svgPath<span class=\"token punctuation\">:</span> <span class=\"token string\">\"M642.97,979.16L643.67,982.94L647.4,986...\"</span><span class=\"token punctuation\">,</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Bedfordshire\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    svgPath<span class=\"token punctuation\">:</span><span class=\"token string\">\"M612.68,1061.2L613.28,1059L614.67,1058.64L...\"</span><span class=\"token punctuation\">,</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Berkshire\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<h2>The <MapContainer> Component üó∫Ô∏è ‚û°Ô∏è üì¶</h2>\n<p>This is our first <em>component</em>, but before we begin, let's write the code that will actually hold our application.</p>\n<p>Edit the <code class=\"language-text\">main.js</code> file to include the following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">\"./App.svelte\"</span>\n\n<span class=\"token comment\">//Here we use intro:true so that transitions run on initial load.</span>\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  target<span class=\"token punctuation\">:</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">,</span>\n  intro<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> app</code></pre></div>\n<p>This is our entry file, this is the only file that is not actually written in the \"Svelte\" syntax (I say that loosely as Svelte is very similar to JavaScript).</p>\n<p>We create a new instance of our <code class=\"language-text\">App.svelte</code> component and tell it to add itself to the body of the page using <code class=\"language-text\">target: document.body</code>. We then tell it that we want any animations/transitions on this component and its children to happen when we first load the component. (By default Svelte only plays animations/transitions when a component is mounted for a second time). We do this by adding the <code class=\"language-text\">intro: true</code> property, this is important as we want to animate the map by drawing it when you first load the page.</p>\n<p>Once you have done this, you won't see anything on the page as you need to edit the <code class=\"language-text\">App.svelte</code> file. As a test, let's pull in our Regions and put their names onto the screen using a Svelte <code class=\"language-text\">#each</code> loop.</p>\n<p>In the <code class=\"language-text\">App.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> Regions <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Data/Regions.js\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n{#each Regions as { name }}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>{name}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n{/each}</code></pre></div>\n<p>Here we import the Regions array from <code class=\"language-text\">Regions.js</code> as you do with normal JavaScript, we then create an <code class=\"language-text\">#each</code> loop and then for each item in the Regions array, we put an <code class=\"language-text\">&lt;h1&gt;</code> tag onto the page with the name of the region inside.</p>\n<p>Your page should have reloaded and you should now seen the name of each region on the page.</p>\n<p>Now we have our basic setup, let's actually create our <code class=\"language-text\">&lt;MapContainer&gt;</code> component. This component will just be an SVG that lets us put any valid SVG code inside of it and it will be used to house the svgPaths of our regions. This way we can seperate our regions (which are just svg paths) from their parent SVG element.</p>\n<p>Start by creating a folder called <code class=\"language-text\">Components</code> inside of the <code class=\"language-text\">src</code> folder. Inside of that folder, create a new file called <code class=\"language-text\">MapContainer.svelte</code></p>\n<p>In the <code class=\"language-text\">MapContainer.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">let</span> width <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n  <span class=\"token keyword\">let</span> height <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{width}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{height}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This a is a very simple component that defines a width and height and then creates and SVG element with that width and height. Obviously nothing will display on the page as there is nothing inside of the SVG and we haven't even imported it into our <code class=\"language-text\">App.svelte</code> file.</p>\n<p>Let's make it so we can pass in a width and height to our component when we create it. You do this by placing <code class=\"language-text\">export</code> in front of variables within the JavaScript. This tells Svelte that we wish to provide values when we instantiate the component.</p>\n<p>We can also simplify the usage of the width and height as attributes because they are named the same by just removing the <code class=\"language-text\">width=</code> part on the svg element.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> width <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> height <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">{width}</span> <span class=\"token attr-name\">{height}</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>If no value is given for width or height, they will fallback to <code class=\"language-text\">&quot;100%&quot;</code>, you can also choose not to provide a default value and in that case it will default to <code class=\"language-text\">undefined</code> when nothing is provided.</p>\n<p>Let's remove the example code and put it on our page,</p>\n<p>In the <code class=\"language-text\">App.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> MapContainer <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Components/MapContainer.svelte\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapContainer</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>800px<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>600px<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>You should now be able to see an empty SVG element on the page if you inspect it using dev tools. Let's turn this into something more useful!</p>\n<p>First let's remove the export from our width and height variables, we will be deciding this based on the elements inside of the SVG later on so we don't need to provide any values.</p>\n<p>Next, let's create something called a <code class=\"language-text\">&lt;slot&gt;</code> inside of our SVG element. A slot is a feature of Svelte that allows us to decide where elements placed inside of a component when it is created should appear <em>inside</em> the actual component.</p>\n<p>In the <code class=\"language-text\">MapContainer.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">let</span> width <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n  <span class=\"token keyword\">let</span> height <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">{width}</span> <span class=\"token attr-name\">{height}</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>regions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>slot</span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This means that we can do something like the following in the <code class=\"language-text\">App.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> MapContainer <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Components/MapContainer.svelte\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapContainer</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>rect</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>100<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">fill</span><span class=\"token punctuation\">:</span>red</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MapContainer</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Inside of our component, it will turn into:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">{width}</span> <span class=\"token attr-name\">{height}</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>regions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>rect</span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>300<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>100<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">fill</span><span class=\"token punctuation\">:</span>red</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>as the contents inside of <code class=\"language-text\">&lt;MapContainer&gt; &lt;/MapContainer&gt;</code> are placed inside of the <code class=\"language-text\">&lt;slot&gt;</code>.</p>\n<p>You should now see a red rectangle on the screen.</p>\n<p>Using what we've written, let's get our map onto the page.</p>\n<p>Let's add our <code class=\"language-text\">#each</code> loop back into the <code class=\"language-text\">App.svelte</code> file, but this time we will pull through and put the svgPath onto the page and inside of our <code class=\"language-text\">MapContainer</code> component.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> MapContainer <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Components/MapContainer.svelte\"</span>\n  <span class=\"token keyword\">import</span> Regions <span class=\"token keyword\">from</span> <span class=\"token string\">\"./Data/Regions.js\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapContainer</span><span class=\"token punctuation\">></span></span>\n  {#each Regions as { name, svgPath }}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{svgPath}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  {/each}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MapContainer</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>You should now see the full map on the page. What we've just done is essentially re-create the original SVG but as Svelte components.</p>\n<p>You may notice that the map is too big, we can do two things to help us with this. In our <code class=\"language-text\">MapContainer.svelte</code> file above the svg element, we can add some CSS to scale the map.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n  <span class=\"token selector\">.regions</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span>0.75<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This will make it so our map fits within the SVG element, but let's say we didn't know that scaling by <code class=\"language-text\">0.75</code> is the right number (cause it might not be if the contents inside of the svg are different) then we need to make sure the width and height of the svg scale to fit the content inside of it.</p>\n<p>To do this we can use the <code class=\"language-text\">onMount</code> function in Svelte to run some code when our component is added to the page. This code should get the bounding box of our SVG once it has content inside of it and then update the width and height to match it.</p>\n<p>In the <code class=\"language-text\">MapContainer.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> onMount <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"svelte\"</span>\n\n  <span class=\"token keyword\">let</span> svg\n  <span class=\"token keyword\">let</span> width <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n  <span class=\"token keyword\">let</span> height <span class=\"token operator\">=</span> <span class=\"token string\">\"100%\"</span>\n\n  <span class=\"token function\">onMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> svgBoundingBox <span class=\"token operator\">=</span> svg<span class=\"token punctuation\">.</span><span class=\"token function\">getBBox</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    width <span class=\"token operator\">=</span> svgBoundingBox<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> svgBoundingBox<span class=\"token punctuation\">.</span>width <span class=\"token operator\">+</span> svgBoundingBox<span class=\"token punctuation\">.</span>x\n    height <span class=\"token operator\">=</span> svgBoundingBox<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> svgBoundingBox<span class=\"token punctuation\">.</span>height <span class=\"token operator\">+</span> svgBoundingBox<span class=\"token punctuation\">.</span>y\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n  <span class=\"token selector\">.regions</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">scale</span><span class=\"token punctuation\">(</span>0.75<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span> <span class=\"token attr-name\">{width}</span> <span class=\"token attr-name\">{height}</span> <span class=\"token attr-name\"><span class=\"token namespace\">bind:</span>this</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{svg}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>g</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>regions<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>slot</span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>g</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>We import <code class=\"language-text\">onMount</code> from Svelte and then we pass it a function to run. This function does what we described above and, when the width and height change, Svelte automatically re-renders our svg element with the updated values.</p>\n<p>One extra thing you may have noticed is that we have a new variable called <code class=\"language-text\">svg</code> and <code class=\"language-text\">bind:this={svg}</code> on our svg element. All this does is store a reference to the actual svg element inside of the <code class=\"language-text\">svg</code> variable. In our use case, this is like doing <code class=\"language-text\">let svg = document.getElementById(&quot;mySvg&quot;)</code> if our element had the id of \"mySvg\". This allows us to call <code class=\"language-text\">getBBox()</code> on our svg element.</p>\n<p>And That's it! It might seem like a lot of effort just to get our SVG onto the page when we could have just put it directly onto the page but this allows us to directly manage our regions outside of the SVG, which is important as you'll find out in the next section.</p>\n<h2>The Basic <MapRegion> Component üó∫Ô∏è ‚û°Ô∏è üì¶ ‚û°Ô∏è üìç</h2>\n<p>Now we have our SVG as a component, I think it only makes sense to make our paths into components.</p>\n<p>Create a new component called <code class=\"language-text\">MapRegion.svelte</code> and make it take an svgPath that it will output onto the page.</p>\n<p>In the <code class=\"language-text\">MapRegion.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> svgPath\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{svgPath}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>and then in our <code class=\"language-text\">App.svelte</code> file, import our new component and replace the direct path:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapContainer</span><span class=\"token punctuation\">></span></span>\n  {#each Regions as { name, svgPath }}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapRegion</span> <span class=\"token attr-name\">{svgPath}</span> <span class=\"token punctuation\">/></span></span>\n  {/each}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MapContainer</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>We can now do some cool things, let's say we wanted to be able to specify a fill colour for our path, we'd simply export a variable and then use that variable like so:</p>\n<p>In the <code class=\"language-text\">MapRegion.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> svgPath\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> fillColour <span class=\"token operator\">=</span> <span class=\"token string\">\"#333\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span> <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{svgPath}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{fillColour}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>In the <code class=\"language-text\">App.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapContainer</span><span class=\"token punctuation\">></span></span>\n  {#each Regions as { name, svgPath }}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapRegion</span> <span class=\"token attr-name\">{svgPath}</span> <span class=\"token attr-name\">fillColour</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>red<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  {/each}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MapContainer</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>We can also do the same thing for stroke colour and stroke width like so:</p>\n<p>In our <code class=\"language-text\">MapRegion.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> svgPath\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> fillColour <span class=\"token operator\">=</span> <span class=\"token string\">\"#333\"</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> strokeColour <span class=\"token operator\">=</span> <span class=\"token string\">\"#fff\"</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> strokeWidth <span class=\"token operator\">=</span> <span class=\"token string\">\"1px\"</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span>\n  <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{svgPath}<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{fillColour}<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{strokeColour}<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\">\n  <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token selector\">stroke-width:</span> <span class=\"token punctuation\">{</span>strokeWidth<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>In our <code class=\"language-text\">App.svelte</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapContainer</span><span class=\"token punctuation\">></span></span>\n  {#each Regions as { name, svgPath }}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>MapRegion</span>\n    <span class=\"token attr-name\">{svgPath}</span>\n    <span class=\"token attr-name\">fillColour</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>red<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">strokeColour</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>white<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">strokeWidth</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>1px<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n  {/each}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>MapContainer</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This is our very basic <code class=\"language-text\">&lt;MapRegion&gt;</code> component. In the next section we'll spice things up a bit by adding a svelte transition to our map regions so they draw themselves.</p>\n<h2>Adding Transitions to our <MapRegion> Component üó∫Ô∏è ‚û°Ô∏è üì¶ ‚û°Ô∏è üìç ‚û°Ô∏è üí´</h2>\n<p>One of the coolest parts about Svelte is how easy it makes animation. This is mostly because it treats it as first-class functionality.</p>\n<p>We are going to make use of animation by using the Transition directive.</p>\n<p>To get up and running, all we need to do is import the <em>draw</em> transition at the top of our file:</p>\n<p><code class=\"language-text\">import { draw } from &quot;svelte/transition&quot;;</code></p>\n<p>and then add an attribute to our SVG path that tells it to draw itself:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span>\n  <span class=\"token attr-name\"><span class=\"token namespace\">transition:</span>draw</span>\n  <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{svgPath}<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>path<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{fillColour}<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">stroke</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{strokeColour}<span class=\"token punctuation\">\"</span></span><span class=\"token style-attr language-css\"><span class=\"token attr-name\">\n  <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token selector\">stroke-width:</span> <span class=\"token punctuation\">{</span>strokeWidth<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>That results in our SVG that draws itself, although it is each path drawing itself individually:</p>\n<p><img src=\"/lets-create-data-vis-svelte/basic-draw-transition.gif\" alt=\"Basic Draw Transition\"></p>\n<p>but we can make it better, let's start by specifying the speed at which we want to draw each path, we do this by changing our attribute to be:</p>\n<p><code class=\"language-text\">transition:draw={{ duration: 1500 }}</code></p>\n<p>where <code class=\"language-text\">1500</code> is the time in milliseconds the animation should take.</p>\n<p>Now it's kind of hard to see the actual animation because of the conflicting colours. Let's flip the stroke colour and fill colour for the duration of the animation. We first start by defining a new variable in our script tags.</p>\n<p><code class=\"language-text\">let transitionEnded = false;</code></p>\n<p>and then on our path, we can add an event listener that will set our new variable to true once our transition has ended. Svelte handles all of this for us as it knows when our draw transition finishes.</p>\n<p><code class=\"language-text\">on:introend={() =&gt; (transitionEnded = true)}</code></p>\n<p>Now let's add a condition to our fill and stroke attributes to flip the colours if transitionEnded is false.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">&lt;path transition:draw={{ duration: 1500 }} on:introend={() => (transitionEnded =\ntrue)} d={svgPath} class=\"path\" fill={transitionEnded ? fillColour :\nstrokeColour} stroke={transitionEnded ? strokeColour : fillColour}\nstyle=\"stroke-width: {strokeWidth}\" /></code></pre></div>\n<p>As a final touch, let's add a CSS transition to our fill attribute so that when the fill colour is set, it doesn't just flash onto the screen.</p>\n<p>Add the following CSS rule to the <code class=\"language-text\">&lt;style&gt;</code> tags:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n  <span class=\"token selector\">.path</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> fill 0.5s ease<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>If everything has gone smoothly, we should end up with something that looks like the following, excluding the choppy gif of course:</p>\n<p><img src=\"/lets-create-data-vis-svelte/finished-draw-transition.gif\" alt=\"Final Draw Transition\"></p>","frontmatter":{"date":"November 25, 2019","path":"/blog/lets-create-data-vis-svelte","title":"Lets Create: A Data Visualization using Svelte","description":"In this article we'll create a data visualization using the Svelte.js framework that shows, on a map of the UK, which regions have contributed most to English Premier League title wins since its creation in 1992."}}},"pageContext":{"isCreatedByStatefulCreatePages":false}}}